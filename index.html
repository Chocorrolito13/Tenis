<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Catálogo de Tenis</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Poppins', sans-serif;
    }

    header {
      background: linear-gradient(90deg, #000, #444);
      color: white;
    }

    .card {
      border: none;
      background-color: #fff;
      transition: transform 0.3s ease;
      cursor: pointer;
      overflow: hidden;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
    }

    .card-img-container {
      position: relative;
      width: 100%;
      overflow: hidden;
      background-color: #fff;
    }

    .card-img-container img {
      width: 100%;
      display: block;
      transition: opacity 0.4s ease;
      object-fit: contain;
      background-color: #fff;
    }

    .card-img-container img.hover-img {
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
    }

    .card-img-container:hover img.hover-img {
      opacity: 1;
    }

    .card-body {
      text-align: center;
      padding: 1rem;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }

    .card-price {
      font-size: 1rem;
      font-weight: bold;
      color: #111;
      margin-bottom: 0.3rem;
    }

    .card-sizes {
      font-size: 0.85rem;
      color: #555;
    }

    footer {
      background: #000;
      color: #fff;
    }
  </style>
</head>
<body>

  <header class="text-center py-4">
    <h1 class="fw-bold mb-0">Catálogo de Tenis</h1>
    <p class="mb-0">Modelos disponibles actualizados automáticamente</p>
  </header>

  <main class="container my-5">
    <div id="lista-productos" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4"></div>
  </main>

  <footer class="text-center py-4">
    © 2025 Catálogo de Tenis | Actualizado desde SNKRS Mayoreo
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const contenedor = document.getElementById("lista-productos");

      // Margen de ganancia según tipo de tenis
      const MARGEN_PRODUCTO = (title) => {
        const t = title.toLowerCase();
        if (t.includes("premium") || t.includes("retro") || t.includes("limited")) return 0.50;
        if (t.includes("air") || t.includes("max") || t.includes("force")) return 0.40;
        return 0.35;
      };

      async function cargarProductos() {
        try {
          const res = await fetch("https://snkrsmayoreo.mx/collections/modelos-disponibles-1/products.json");
          const data = await res.json();

          if (!data.products) {
            contenedor.innerHTML = "<p class='text-danger'>No se pudieron cargar los productos.</p>";
            return;
          }

          const productos = data.products.map(p => {
            const costo = p.variants[0]?.price ? parseFloat(p.variants[0].price) : 0;
            const margen = MARGEN_PRODUCTO(p.title);
            const precioFinal = (costo / (1 - margen)).toFixed(2);

            const tallas = p.variants
              .filter(v => v.available)
              .map(v => v.title)
              .join(", ");

            return {
              title: p.title,
              image: p.images[0]?.src || "https://via.placeholder.com/300?text=Sin+Imagen",
              imageHover: p.images[1]?.src || p.images[0]?.src,
              precio: precioFinal,
              tallas: tallas || "Sin tallas disponibles"
            };
          });

          mostrarProductos(productos);
        } catch (err) {
          console.error("Error cargando productos:", err);
          contenedor.innerHTML = "<p class='text-danger'>No se pudieron cargar los productos.</p>";
        }
      }

      function mostrarProductos(lista) {
        contenedor.innerHTML = "";
        lista.forEach(prod => {
          const col = document.createElement("div");
          col.classList.add("col");

          col.innerHTML = `
            <div class="card h-100">
              <div class="card-img-container">
                <img src="${prod.image}" alt="${prod.title}" class="main-img">
                <img src="${prod.imageHover}" alt="${prod.title}" class="hover-img">
              </div>
              <div class="card-body">
                <h5 class="card-title">${prod.title}</h5>
                <div class="card-price">$${prod.precio} MXN</div>
                <div class="card-sizes">Tallas: ${prod.tallas}</div>
              </div>
            </div>
          `;
          contenedor.appendChild(col);
        });
      }

      cargarProductos();
    });
  </script>
</body>
</html>
